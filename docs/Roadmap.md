# ğŸš€ å‰ç«¯æ¸²æŸ“æ¶æ„æ¼”è¿›è§„åˆ’ï¼ˆSSG â†’ RSC â†’ ISR â†’ SSRï¼‰

## ğŸ¯ æ€»ä½“ç›®æ ‡

åˆ†é˜¶æ®µå®ç°ä¸€å¥—å¯æ¼”è¿›çš„ React 19 æ¶æ„ï¼š

1. **Phase 1ï¼šçº¯ SSGï¼ˆStatic Site Generationï¼‰** â€”â€” å®ç°é™æ€æ„å»ºä¸éƒ¨ç½²ï¼›
2. **Phase 2ï¼šå¼•å…¥ RSCï¼ˆReact Server Componentsï¼‰** â€”â€” å‡å°‘ JS ä½“ç§¯ï¼›
3. **Phase 3ï¼šåŠ å…¥ ISRï¼ˆIncremental Static Regenerationï¼‰** â€”â€” æ”¯æŒå¢é‡å†ç”Ÿï¼›
4. **Phase 4ï¼šè¡¥å…… SSRï¼ˆServer-Side Renderingï¼‰** â€”â€” æ”¯æŒå®æ—¶åŠ¨æ€é¡µé¢ï¼›

æ¯é˜¶æ®µéƒ½ä¿è¯å¯ç°åº¦ã€å¯è§‚æµ‹ã€å¯å›æ»šã€‚

---

## ğŸ“ MVP å­¦ä¹ ç‰ˆï¼ˆç®€åŒ–è·¯çº¿ï¼‰

> **è¯´æ˜**ï¼šæœ¬é¡¹ç›®æä¾›ä¸¤æ¡è·¯çº¿ â€”â€” **MVP å­¦ä¹ ç‰ˆ**å’Œ**ç”Ÿäº§å®Œæ•´ç‰ˆ**ã€‚å¦‚æœæ˜¯å­¦ä¹ ç›®çš„ï¼Œå»ºè®®ä» MVP ç‰ˆå¼€å§‹ã€‚

### æŠ€æœ¯æ ˆé€‰æ‹©

- **æ„å»ºå·¥å…·**: Webpack 5
- **React**: React 19 (RC)
- **TypeScript**: 5.x
- **è¿è¡Œæ—¶**: Node.js 18+
- **åŒ…ç®¡ç†**: pnpm

### MVP-Phase 0ï¼šæœ€å° SSG ç³»ç»Ÿï¼ˆ1-2 å¤©ï¼‰âœ… å·²å®Œæˆ

**ç›®æ ‡**ï¼š30 åˆ†é’Ÿå†…è·‘é€šç¬¬ä¸€ä¸ªé™æ€é¡µé¢

**æ ¸å¿ƒä»»åŠ¡**ï¼š
- [x] å®‰è£…åŸºç¡€ä¾èµ–ï¼šreact@rc, react-dom@rc, webpack, typescript
- [x] å»ºç«‹é¡¹ç›®ç»“æ„ï¼š`src/pages/`, `src/lib/`, `tsconfig.json`
- [x] å®ç°æ ¸å¿ƒæ„å»ºè„šæœ¬ï¼š`src/lib/builder.ts`ï¼ˆçº¦ 130 è¡Œï¼‰
  - è¯»å–è·¯ç”±é…ç½®
  - è°ƒç”¨ `renderToString()` ç”Ÿæˆ HTML
  - å†™å…¥ `dist/` ç›®å½•
- [x] æ·»åŠ ä¸€ä¸ªç®€å•é¡µé¢ï¼š`src/pages/index.tsx`
- [x] å®ç°å‘½ä»¤ï¼š`pnpm build` â†’ ç”Ÿæˆ `dist/index.html`
- [x] åˆ›å»º README.md é¡¹ç›®æ–‡æ¡£

**ç®€åŒ–ç‚¹**ï¼š
- âŒ æ—  CDNã€S3ï¼ˆç›´æ¥æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼‰
- âŒ æ— å¤æ‚è·¯ç”±ï¼ˆå…ˆæ”¯æŒ 3-5 ä¸ªé™æ€è·¯ç”±ï¼‰
- âŒ æ— æŒ‡çº¹åŒ–ã€æ— ä»£ç åˆ†å‰²ï¼ˆå…ˆç”¨æœ€ç®€å•çš„ bundleï¼‰

**éªŒæ”¶**ï¼š
```bash
pnpm build
open dist/index.html  # æµè§ˆå™¨èƒ½çœ‹åˆ° React æ¸²æŸ“çš„å†…å®¹
```

---

### MVP-Phase 1ï¼šClient å²›å±¿ + Hydrationï¼ˆ2-3 å¤©ï¼‰âœ… å·²å®Œæˆ

**ç›®æ ‡**ï¼šç†è§£æœåŠ¡ç«¯/å®¢æˆ·ç«¯æ¸²æŸ“è¾¹ç•Œ

**æ ¸å¿ƒä»»åŠ¡**ï¼š
- [x] æ·»åŠ äº¤äº’ç»„ä»¶ï¼š`src/components/Counter.client.tsx`ï¼ˆå¸¦ `"use client"` æ ‡è®°ï¼‰
- [x] é…ç½® Webpack åŒå…¥å£ï¼š
  - Server å…¥å£ï¼šç”¨äºæ„å»ºæ—¶æ¸²æŸ“
  - Client å…¥å£ï¼šç”¨äºæµè§ˆå™¨ç«¯ hydration
- [x] åœ¨ç”Ÿæˆçš„ HTML ä¸­æ³¨å…¥ `<script>` æ ‡ç­¾
- [x] å®ç°å®¢æˆ·ç«¯ hydrationï¼š`hydrateRoot()`
- [x] æ·»åŠ æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼ˆserveï¼‰
- [x] ä¿®æ”¹ webpack.config.js â†’ webpack.config.cjsï¼ˆES module å…¼å®¹ï¼‰

**å…³é”®ä»£ç ç»“æ„**ï¼š
```
src/
  pages/
    index.tsx              # é¡µé¢ï¼ˆServer Componentï¼‰
  components/
    Counter.client.tsx     # å®¢æˆ·ç«¯ç»„ä»¶ï¼ˆå¸¦äº¤äº’ï¼‰
  entries/
    server.tsx             # æ„å»ºæ—¶å…¥å£
    client.tsx             # æµè§ˆå™¨å…¥å£ï¼ˆhydrationï¼‰
  lib/
    builder.ts             # æ„å»ºè„šæœ¬
webpack.config.js          # åŒå…¥å£é…ç½®
```

**ç®€åŒ–ç‚¹**ï¼š
- âŒ ä¸åšä»£ç åˆ†å‰²ï¼ˆæ‰€æœ‰ client ç»„ä»¶æ‰“æˆä¸€ä¸ª bundleï¼‰
- âŒ ä¸åšæŒ‰éœ€åŠ è½½ï¼ˆå…¨é‡ hydrationï¼‰

**éªŒæ”¶ç»“æœ**ï¼šâœ… å…¨éƒ¨é€šè¿‡
- âœ… é¡µé¢åˆå§‹ HTML ç”±æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç èƒ½çœ‹åˆ°å®Œæ•´ Counter HTMLï¼‰
- âœ… äº¤äº’åŠŸèƒ½æ­£å¸¸ï¼ˆCounter ç‚¹å‡»èƒ½è®¡æ•°ï¼Œstate å®æ—¶æ›´æ–°ï¼‰
- âœ… æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º hydration æ—¥å¿—
- âœ… å®¢æˆ·ç«¯ JS bundle æˆåŠŸåŠ è½½ï¼ˆdist/assets/client.js ~1MB å¼€å‘æ¨¡å¼ï¼‰
- âœ… æœ¬åœ°æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:3000ï¼‰

**æ„å»ºäº§ç‰©**ï¼š
- `dist/index.html`: 2.6KBï¼ˆå«æœåŠ¡ç«¯æ¸²æŸ“çš„å®Œæ•´ HTMLï¼‰
- `dist/assets/client.js`: 1.0MBï¼ˆå¼€å‘æ¨¡å¼ï¼Œæœªå‹ç¼©ï¼‰
- `dist/assets/client.js.map`: 1.2MBï¼ˆSource mapï¼‰

**æ„å»ºæ—¶é—´**ï¼š
- Webpack å®¢æˆ·ç«¯æ‰“åŒ…ï¼š~3.6s
- SSG HTML ç”Ÿæˆï¼š~32ms
- æ€»è®¡ï¼š~3.7s

---

### MVP-Phase 2ï¼šç®€åŒ–ç‰ˆ RSCï¼ˆ3-5 å¤©ï¼‰âš ï¸ é«˜éš¾åº¦

**ç›®æ ‡**ï¼šæ‰‹å†™ç®€åŒ–çš„ RSC å®ç°ï¼Œç†è§£ Server Components åŸç†

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- Server Component åœ¨æ„å»ºæ—¶æ‰§è¡Œï¼Œåªè¾“å‡ºæ•°æ®/HTML
- Client Component åœ¨æµè§ˆå™¨æ‰§è¡Œ
- å®ç°ç®€åŒ–çš„ RSC Payloadï¼ˆJSON æ ¼å¼ï¼‰

**æ ¸å¿ƒä»»åŠ¡**ï¼š
- [ ] å®ç°ç»„ä»¶æ ‘åˆ†æï¼šåŒºåˆ† Server å’Œ Client ç»„ä»¶
- [ ] Server Component æ‰§è¡Œé€»è¾‘ï¼š
  - åœ¨æ„å»ºæ—¶è¿è¡Œ `async` ç»„ä»¶
  - åºåˆ—åŒ–ä¸º JSONï¼ˆç®€åŒ–ç‰ˆ RSC Payloadï¼‰
- [ ] Client ä¾§ååºåˆ—åŒ–ï¼š
  - è¯»å– RSC Payload
  - é‡å»ºç»„ä»¶æ ‘
  - åª hydrate Client Components

**ç®€åŒ–ç‚¹**ï¼š
- âŒ ä¸å®ç°å®Œæ•´ RSC Wire Formatï¼ˆç”¨ç®€åŒ–çš„ JSONï¼‰
- âŒ ä¸æ”¯æŒ Streamingï¼ˆåªåšé™æ€æ„å»ºï¼‰
- âŒ ä¸å®ç° Server Actions

**å‚è€ƒèµ„æ–™**ï¼š
- React å®˜æ–¹ RSC Demo: https://github.com/reactjs/server-components-demo
- Dan Abramov çš„ RSC æ–‡ç« 

**éªŒæ”¶**ï¼š
- Server Component èƒ½è®¿é—®æ„å»ºæ—¶æ•°æ®ï¼ˆå¦‚è¯»æ–‡ä»¶ã€è°ƒ APIï¼‰
- Client Component ä»ç„¶æ­£å¸¸äº¤äº’
- å®¢æˆ·ç«¯ JS Bundle æ˜æ˜¾å‡å°ï¼ˆServer Component ä»£ç ä¸æ‰“åŒ…ï¼‰

---

### MVP-Phase 3-4ï¼šæš‚æ—¶è·³è¿‡ â­ï¸

**å»ºè®®**ï¼š
- ISR å’Œ SSR éœ€è¦æœåŠ¡ç«¯è¿è¡Œæ—¶ï¼Œå¤æ‚åº¦è¾ƒé«˜
- å»ºè®®å…ˆå®Œæˆ MVP-Phase 0-2ï¼Œå……åˆ†ç†è§£ SSG å’Œ RSC åŸç†
- åç»­å¯é€‰æ‹©ï¼š
  - ç»§ç»­æ‰‹å†™ ISR/SSRï¼ˆå·¥ä½œé‡å¤§ï¼‰
  - è½¬å‘ Next.js å­¦ä¹ ç”Ÿäº§å®è·µ

---

## ğŸ“‹ MVP å¿«é€Ÿå¯åŠ¨æ£€æŸ¥æ¸…å• âœ… å·²å®Œæˆ

### ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡ï¼ˆ5 åˆ†é’Ÿï¼‰âœ…
```bash
node --version    # ç¡®ä¿ >= 18
pnpm --version    # ç¡®ä¿å·²å®‰è£… pnpm
```

### ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–ï¼ˆ10 åˆ†é’Ÿï¼‰âœ…
```bash
pnpm add react@rc react-dom@rc
pnpm add -D webpack webpack-cli webpack-dev-server
pnpm add -D @types/react @types/react-dom @types/node
pnpm add -D typescript tsx ts-loader
pnpm add -D html-webpack-plugin
```

### ç¬¬ä¸‰æ­¥ï¼šå»ºç«‹é¡¹ç›®éª¨æ¶ï¼ˆ15 åˆ†é’Ÿï¼‰âœ…
- [x] åˆ›å»º `src/pages/index.tsx`ï¼ˆä¸€ä¸ªç®€å•çš„ React ç»„ä»¶ï¼‰
- [x] åˆ›å»º `src/lib/builder.ts`ï¼ˆæ ¸å¿ƒæ„å»ºè„šæœ¬ï¼‰
- [x] åˆ›å»º `tsconfig.json`
- [x] åœ¨ `package.json` æ·»åŠ è„šæœ¬ï¼š`"build": "tsx src/lib/builder.ts"`
- [x] åˆ›å»º `src/routes.config.ts`ï¼ˆè·¯ç”±é…ç½®ï¼‰
- [x] åˆ›å»º `README.md`ï¼ˆé¡¹ç›®æ–‡æ¡£ï¼‰

### ç¬¬å››æ­¥ï¼šéªŒè¯ï¼ˆ5 åˆ†é’Ÿï¼‰âœ…
```bash
pnpm build          # âœ… æ„å»ºæˆåŠŸï¼ˆ47msï¼‰
ls dist/            # âœ… çœ‹åˆ° index.html
open dist/index.html # âœ… æµè§ˆå™¨æ­£å¸¸æ˜¾ç¤º
```

**éªŒæ”¶ç»“æœ**ï¼š
- âœ… `dist/index.html` å·²ç”Ÿæˆï¼ˆ1.6KBï¼‰
- âœ… æŸ¥çœ‹ç½‘é¡µæºä»£ç èƒ½çœ‹åˆ°å®Œæ•´ HTML
- âœ… æµè§ˆå™¨æ˜¾ç¤ºæ­£å¸¸ï¼ŒåŒ…å«æ ·å¼å’Œå†…å®¹
- âœ… æ— éœ€æœåŠ¡å™¨å³å¯è¿è¡Œ

---

## ğŸ”„ ä» MVP åˆ°ç”Ÿäº§å®Œæ•´ç‰ˆ

å®Œæˆ MVP å­¦ä¹ åï¼Œå¦‚éœ€ç”Ÿäº§éƒ¨ç½²ï¼Œå‚è€ƒä¸‹æ–¹å®Œæ•´ç‰ˆ Roadmapï¼š
- æ·»åŠ  CDNã€S3 éƒ¨ç½²
- æ·»åŠ æŒ‡çº¹åŒ–ã€ä»£ç åˆ†å‰²
- æ·»åŠ ç›‘æ§ã€å‘Šè­¦
- å®ç°å®Œæ•´çš„ ISRã€SSR

---

## ğŸ§± Phase 0ï¼šåœ°åŸºï¼ˆå¯æ¼”è¿›åŸºçº¿ï¼‰

**ç›®æ ‡**ï¼šç¡®ä¿ä»ç¬¬ä¸€å¤©èµ·é¡¹ç›®ç»“æ„èƒ½å…¼å®¹åç»­æ¶æ„æ¼”è¿›ã€‚

### æ ¸å¿ƒçº¦å®š

* `fetchPageData(params)`: çº¯å‡½æ•°ï¼Œå¯åœ¨æ„å»º/å†ç”Ÿ/SSR å¤ç”¨ã€‚
* `render(url, data)`: æ¸²æŸ“æ¥å£ï¼›åç»­å¯æ¢æˆ RSC æ¸²æŸ“å®ç°ã€‚
* `routes.config.ts`: å®šä¹‰è·¯ç”±æ¨¡å¼ä¸å†ç”Ÿç­–ç•¥ã€‚

### äº§ç‰©ç›®å½•

```
dist/
  pages/**/index.html
  assets/**
  manifests/{client.json, rsc.json}
  manifest.json
```

### åŸºç¡€è®¾æ–½

* æ„å»ºå‘½ä»¤ï¼š`build:static` â†’ è¾“å‡º `dist/static`
* éƒ¨ç½²ï¼šä¸Šä¼ è‡³ S3/R2ï¼Œå‰ç½® CDNï¼ˆCloudFront/Cloudflareï¼‰

---

## ğŸ§© Phase 1ï¼šçº¯ SSGï¼ˆæ—  RSCã€æ—  ISRï¼‰

**ç›®æ ‡**ï¼šå…¨ç«™é™æ€åŒ–ä¸Šçº¿ï¼Œç¡®ä¿æè‡´åŠ è½½é€Ÿåº¦ã€‚

### å†…å®¹

* æ¨¡æ¿é™æ€æ¸²æŸ“ï¼Œäº¤äº’ç”¨ `use client` å²›å±¿ã€‚
* ç”Ÿæˆé™æ€ HTML + æŒ‡çº¹åŒ– JS/CSSã€‚

### ç¼“å­˜ç­–ç•¥

* HTML: `Cache-Control: public, s-maxage=86400, max-age=0`
* JS/CSS/Images: `public, max-age=31536000, immutable`

### éªŒæ”¶æ ‡å‡†

* Lighthouse Performance â‰¥ 95
* é¦–å± HTML ç›´å‡ºï¼ŒSEO é€šè¿‡çˆ¬è™«æ£€æµ‹ã€‚

### è§‚æµ‹æŒ‡æ ‡

* CDN å‘½ä¸­ç‡ â‰¥ 95%
* å¹³å‡ TTFB < 100ms

---

## âš™ï¸ Phase 2ï¼šå¼•å…¥ RSCï¼ˆæ„å»ºæœŸæ‰§è¡Œï¼‰

**ç›®æ ‡**ï¼šå‡å°‘å®¢æˆ·ç«¯ JS ä½“ç§¯ï¼Œå°†æ‹¼è£…é€»è¾‘è¿ç§»åˆ° Server Componentsã€‚

### å†…å®¹

* é»˜è®¤ç»„ä»¶å‡ä¸º Server Componentsã€‚
* ä»…äº¤äº’é€»è¾‘ä¿ç•™åœ¨ `*.client.tsx`ã€‚
* æ„å»ºæœºæ‰§è¡Œ RSC â†’ äº§å‡º HTML + `rsc.json`ã€‚

### æ”¹é€ ä¼˜å…ˆçº§

1. Markdown/æ–‡æ¡£æ¸²æŸ“æ¨¡å—ã€‚
2. å†…å®¹èšåˆé¡µï¼ˆåˆ—è¡¨ã€ç›®å½•ã€æ¨èï¼‰ã€‚
3. å¤šè¯­è¨€æ¨¡æ¿æ‹¼è£…ã€‚

### éªŒæ”¶æ ‡å‡†

* JS Bundle å‡å°‘ â‰¥ 30%
* Hydration æ—¶é—´ä¸‹é™ â‰¥ 40%

### é£é™©æ§åˆ¶

* ç¬¬ä¸‰æ–¹åº“åªæ”¯æŒæµè§ˆå™¨ï¼šä»…é™ client ç»„ä»¶ä½¿ç”¨ã€‚

---

## ğŸ”„ Phase 3ï¼šåŠ å…¥ ISRï¼ˆå¢é‡å†ç”Ÿï¼‰

**ç›®æ ‡**ï¼šæ”¯æŒå†…å®¹æ›´æ–°è‡ªåŠ¨å†ç”Ÿï¼Œæ— éœ€å®æ—¶æ¸²æŸ“ã€‚

### è§¦å‘æ–¹å¼

1. **SWR è§¦å‘**ï¼š

   * HTML å“åº”å¤´ï¼š`Cache-Control: public, s-maxage=300, stale-while-revalidate=86400`
   * è¿‡æœŸæ—¶åå°å†ç”Ÿæ–°é¡µé¢ã€‚

2. **Webhook è§¦å‘**ï¼š

   * CMS/DB æ›´æ–° â†’ è§¦å‘å†ç”Ÿé˜Ÿåˆ— â†’ è°ƒç”¨ `fetchPageData + renderRSC()`ã€‚
   * S3 åŸå­æ›¿æ¢ + CDN ç²¾ç¡®è½¯æ¸…ã€‚

### å†ç”Ÿæµç¨‹

* å†ç”Ÿä»»åŠ¡ â†’ æ¸²æŸ“ HTML â†’ ä¸Šä¼ ä¸´æ—¶å¯¹è±¡ â†’ éªŒè¯é€šè¿‡ååˆ‡æ¢ç‰ˆæœ¬ã€‚

### éªŒæ”¶æ ‡å‡†

* æ›´æ–°å»¶è¿Ÿ â‰¤ 60 ç§’ï¼ˆWebhook æ¨¡å¼ï¼‰
* å†ç”Ÿå¤±è´¥ç‡ < 1%

### é£é™©ä¸æ²»ç†

* é¿å…å†ç”ŸæƒŠç¾¤ï¼šåŠ  route çº§é”ã€‚
* æ§åˆ¶å†ç”Ÿé¢‘ç‡ï¼Œé˜Ÿåˆ—ç›‘æ§ã€‚

---

## ğŸ–¥ï¸ Phase 4ï¼šè¡¥ SSRï¼ˆServer-Side Renderingï¼‰æœåŠ¡ç«¯æ¸²æŸ“

**ç›®æ ‡**ï¼šä¸ºå°éƒ¨åˆ†éœ€è¦å®æ—¶è®¡ç®—çš„é¡µé¢ï¼ˆå¦‚ /dashboardã€/checkoutï¼‰æä¾› SSRã€‚

### è·¯ç”±æ¨¡å¼é…ç½®

```ts
export const rules = [
  { pattern: '/', mode: 'static', revalidate: 300 },
  { pattern: '/blog/[slug]', mode: 'static', revalidate: 600 },
  { pattern: '/dashboard/**', mode: 'ssr' },
  { pattern: '/api/**', mode: 'ssr' },
  { pattern: '/checkout/**', mode: 'ssr' },
];
```

### äº§ç‰©

* `dist/static` â†’ é™æ€é¡µé¢ (SSG+RSC+ISR)
* `dist/server` â†’ SSR è¿è¡ŒåŒ… (Lambda/Workers/Node)

### CDN åˆ†æµ

| Path           | Origin | Cache        | è¯´æ˜                |
| -------------- | ------ | ------------ | ----------------- |
| `/api/*`       | SSR æº  | no-store     | æ¥å£/Server Actions |
| `/dashboard/*` | SSR æº  | no-store     | ç™»å½•é¡µ/æ§åˆ¶å°           |
| `/*`           | S3 é™æ€æº | s-maxage=300 | é»˜è®¤é™æ€å‘½ä¸­            |

### éªŒæ”¶æ ‡å‡†

* SSR è·¯ç”± TTFB â‰¤ 500ms
* é™æ€å‘½ä¸­ç‡ â‰¥ 95%
* åŠ¨æ€é”™è¯¯ç‡ < 0.5%

---

## ğŸ“Š é˜¶æ®µå¯¹æ¯”ä¸€è§ˆ

| é˜¶æ®µ      | æ¸²æŸ“æ¨¡å¼                  | äº§ç‰©ç±»å‹               | åŠ¨æ€èƒ½åŠ›  | æ›´æ–°æ–¹å¼        | å¤æ‚åº¦  |
| ------- | --------------------- | ------------------ | ----- | ----------- | ---- |
| Phase 1 | SSG                   | HTML + JS          | âŒ     | æ‰‹åŠ¨æ„å»º        | â­    |
| Phase 2 | SSG + RSC             | HTML + JS + RSC æ¸…å• | âŒ     | æ‰‹åŠ¨æ„å»º        | â­â­   |
| Phase 3 | SSG + RSC + ISR       | HTML + RSC + å†ç”Ÿä»»åŠ¡  | âœ…(ç¦»çº¿) | SWR/Webhook | â­â­â­  |
| Phase 4 | SSG + RSC + ISR + SSR | åŒäº§ç‰© (é™æ€+æœåŠ¡ç«¯)       | âœ…(å®æ—¶) | æ··åˆ          | â­â­â­â­ |

---

## âœ… éªŒæ”¶ & å›æ»šæ ‡å‡†

* **åŠŸèƒ½å®Œæ•´**ï¼šè·¯ç”±è®¿é—®æ­£å¸¸ï¼Œæ•°æ®æ¸²æŸ“æ­£ç¡®ã€‚
* **æ€§èƒ½è¾¾æ ‡**ï¼šLCP/TTFB â‰¥ 90 åˆ†ä½ä¼˜äºåŸºçº¿ã€‚
* **ç¼“å­˜å‘½ä¸­**ï¼šé™æ€å‘½ä¸­ç‡ â‰¥ 95%ã€‚
* **å†ç”Ÿç¨³å®š**ï¼šé˜Ÿåˆ—é•¿åº¦ã€å¤±è´¥ç‡ã€å»¶è¿Ÿç›‘æ§ç¨³å®šã€‚
* **ä¸€é”®å›æ»š**ï¼šç‰ˆæœ¬åŒ– S3 å¯¹è±¡ + CDN Invalidationã€‚

---

## ğŸ›  å®æ–½ TODO æ¸…å•

### å…¨å±€åŸºçº¿ï¼ˆPhase 0 å…±ç”¨ï¼‰

* [ ] æ˜ç¡®æ¸²æŸ“è¾¹ç•Œï¼šé»˜è®¤ `server components`ï¼Œä»…äº¤äº’åŠ  `"use client"`
* [ ] è®¾è®¡ `fetchPageData(params)` çº¯å‡½æ•°ï¼ˆæ— è¯·æ±‚æ€ã€å¯é‡å…¥ã€å¯ç¼“å­˜ï¼‰
* [ ] ç»Ÿä¸€ `render(url, data)` æ¸²æŸ“æ¥å£ï¼ˆåç»­å¯åˆ‡ RSC å®ç°ï¼‰
* [ ] å»ºç«‹ `routes.config.ts`ï¼ˆ`mode: static|ssr`ã€`revalidate`ã€`cacheTags`ï¼‰
* [ ] äº§ç‰©è§„èŒƒä¸ç›®å½•ç¨³å®šåŒ–ï¼š`/pages/**/index.html`ã€`/assets/**`ã€`/manifests/*`ã€`manifest.json`
* [ ] ç¯å¢ƒé…ç½®åˆ†å±‚ï¼šæœ¬åœ°/CI/Pre/Prodï¼ˆSecretsã€API Baseã€DB/Token æƒé™æœ€å°åŒ–ï¼‰
* [ ] åŸºå‡†æµ‹è¯•ï¼šé¦–å±ã€TTFBã€åŒ…ä½“ç§¯ä¸å…³é”®è·¯ç”±åŸºçº¿è®°å½•

### Phase 1ï¼šçº¯ SSG

* [ ] è·¯ç”±æ‰«æä¸é™æ€åŒ–è„šæœ¬ï¼ˆæ”¯æŒåŠ¨æ€å‚æ•°æšä¸¾ `generateStaticParams`ï¼‰
* [ ] å®¢æˆ·ç«¯å²›å±¿æ‹†åˆ†ä¸æŒ‰éœ€åˆ†åŒ…ï¼ˆé¿å…å…¨å±€ hydrationï¼‰
* [ ] é™æ€èµ„æºæŒ‡çº¹åŒ–ï¼ˆhashï¼‰ä¸å…¬å…± CDN è·¯å¾„é…ç½®
* [ ] S3/R2 æ¡¶ä¸ Bucket Policyã€ç‰ˆæœ¬åŒ–å¼€å¯
* [ ] CDNï¼ˆCloudFront/Cloudflareï¼‰åŸºç¡€åˆ†å‘åŸŸåã€HTTPSã€HSTS
* [ ] Cache-Controlï¼šHTML é•¿ s-maxageï¼ˆå…ˆä¸ SWRï¼‰ã€Assets `immutable`
* [ ] 404/500/é‡å®šå‘ä¸è§„èŒƒè·¯ç”±ï¼ˆå«å¤šè¯­è¨€ï¼‰
* [ ] Lighthouse & Web Vitals åŸºçº¿è¯„ä¼°

### Phase 2ï¼šå¼•å…¥ RSCï¼ˆæ„å»ºæœŸæ‰§è¡Œï¼‰

* [ ] å°†â€œçº¯å±•ç¤ºâ€æ¨¡æ¿è¿ç§»ä¸º server ç»„ä»¶ï¼›äº¤äº’ä¿ç•™ client å²›å±¿
* [ ] æ„å»ºæœº/å†ç”Ÿæœºçš„ Node è¿è¡Œæ—¶ä¸ä¾èµ–ä½“ç§¯æ²»ç†ï¼ˆpnpmã€å±‚/é•œåƒï¼‰
* [ ] äº§å‡º `manifests/rsc.json` ä¸ `manifests/client.json` çš„ç¨³å®šå¯»å€
* [ ] ç¬¬ä¸‰æ–¹ä»…æµè§ˆå™¨åº“éš”ç¦»åˆ° client ç»„ä»¶ï¼ˆLint è§„åˆ™/CI æ£€æŸ¥ï¼‰
* [ ] åŒ…ä½“ç§¯é¢„ç®—ä¸é¢„è­¦ï¼ˆJS æ€»é‡ã€å„è·¯ç”±å¢é‡é˜ˆå€¼ï¼‰
* [ ] å…³é”®é‡å‹æ­¥éª¤ï¼ˆMDX/ä»£ç é«˜äº®/å›¾åƒå ä½ï¼‰ç§»åˆ° server ä¾§

### Phase 3ï¼šåŠ å…¥ ISRï¼ˆSWR/Webhook äºŒé€‰ä¸€æˆ–æ··åˆï¼‰

* [ ] SWR å¤´ï¼š`s-maxage=300, stale-while-revalidate=86400`ï¼ˆä»… HTMLï¼‰
* [ ] Webhook æµï¼šCMS/DB â†’ äº‹ä»¶é˜Ÿåˆ—ï¼ˆSQS/Kafka/Queueï¼‰â†’ å†ç”Ÿ Worker
* [ ] å†ç”Ÿ Workerï¼š`fetchPageData + renderRSC` â†’ ä¸´æ—¶ Key â†’ æ ¡éªŒ â†’ åŸå­åˆ‡æ¢
* [ ] è·¯ç”±çº§å¹¶å‘é”ä¸å»æŠ–ï¼ˆDynamoDB/Redis/KV/DOï¼‰
* [ ] ç²¾ç¡®è½¯æ¸…ç­–ç•¥ï¼šCloudFront Invalidation/Cache-Tag/Surrogate-Key
* [ ] å†ç”ŸæŒ‡æ ‡ï¼šæ’é˜Ÿæ—¶é•¿ã€æ¸²æŸ“è€—æ—¶ã€å¤±è´¥ç‡ã€å›æ»šæŒ‰é’®

### Phase 4ï¼šå°‘æ•°è·¯ç”±è¡¥ SSRï¼ˆå« PPR/Actionsï¼‰

* [ ] `routes.config.ts` ä¸º `/dashboard/**`ã€`/checkout/**`ã€`/api/**` æ ‡è®° `mode: 'ssr'`
* [ ] æ„å»º SSR è¿è¡Œæ—¶ï¼ˆNode/Lambda/Workersï¼‰ï¼Œå¼€å¯ React 19 PPR
* [ ] CDN Behaviorsï¼š`/*`â†’S3 é™æ€æºï¼›`/api/*`ã€`/dashboard/*`ã€`/checkout/*`â†’SSR æº
* [ ] SSR ç¼“å­˜ç­–ç•¥ï¼šHTML `no-store` æˆ–çŸ­ s-maxageï¼›ç‰‡æ®µ/æ•°æ®å±‚ç¼“å­˜ï¼ˆKV/å†…å­˜ï¼‰
* [ ] Server Actions ä¸é‰´æƒï¼ˆCSRFã€åŒç«™ Cookieã€ç­¾åæ ¡éªŒã€CORSï¼‰
* [ ] å†·å¯åŠ¨æ²»ç†ï¼šæœ€å°åŒ…ã€è¿æ¥å¤ç”¨ã€é¢„çƒ­ã€åŒºåŸŸ/Edge é€‰æ‹©

### åŸºç¡€è®¾æ–½ä¸ CI/CD

* [ ] IaCï¼šCDK/Terraform å®šä¹‰ S3ã€CloudFrontã€Lambda/Workersã€DNS
* [ ] åŒäº§ç‰©æµæ°´çº¿ï¼š`build:static`ï¼ˆRSC ç¦»çº¿ï¼‰ä¸ `build:ssr`ï¼ˆè¿è¡Œæ—¶ï¼‰
* [ ] ç°åº¦å‘å¸ƒï¼šé™æ€é¢ç‰ˆæœ¬æŒ‡é’ˆåˆ‡æ¢ï¼›SSR è“ç»¿/æƒé‡åˆ‡æ¢
* [ ] æœºå¯†ç®¡ç†ï¼šAWS Secrets Manager/Cloudflare Secretsï¼Œæœ€å°æƒé™ IAM/Bindings
* [ ] æˆæœ¬çœ‹æ¿ï¼šCDN å‘½ä¸­ç‡ã€å›æºæ¯”ã€å‡½æ•°è°ƒç”¨è®¡è´¹ã€å­˜å‚¨/æµé‡

### è§‚æµ‹ä¸å‘Šè­¦

* [ ] å‰ç«¯ RUMï¼šTTFB/LCP/INP/CLSï¼ˆåˆ†è·¯ç”±ä¸ŠæŠ¥ï¼‰
* [ ] å†ç”Ÿé“¾è·¯ï¼šé˜Ÿåˆ—é•¿åº¦ã€å¹³å‡/95 åˆ†ä½è€—æ—¶ã€å¤±è´¥ç‡é˜ˆå€¼å‘Šè­¦
* [ ] SSR é“¾è·¯ï¼šTTFBã€å„æ®µå°±ç»ªæ—¶é—´ï¼ˆPPR æ®µï¼‰ã€é”™è¯¯ç‡/å†·å¯åŠ¨å æ¯”
* [ ] CDNï¼šå‘½ä¸­ç‡ã€å›æºç‡ã€4xx/5xxã€è¾¹ç¼˜åœ°åŒºåˆ†å¸ƒ
* [ ] æ—¥å¿—å…³è”ï¼štrace-id è´¯ç©¿æ„å»º/å†ç”Ÿ/SSR/è¾¹ç¼˜

### å®‰å…¨ä¸åˆè§„

* [ ] å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰ï¼š`script-src 'self' 'strict-dynamic'`ã€å­èµ„æºå®Œæ•´æ€§ï¼ˆSRIï¼‰
* [ ] ä¾èµ–å®‰å…¨ï¼šCVE æ‰«æã€é”å®šç‰ˆæœ¬ã€æ„å»ºé•œåƒåŠ å›º
* [ ] æ•°æ®æºè®¿é—®ï¼šåªåœ¨æ„å»º/å†ç”Ÿ/SSR æœºè¯»ç§åŸŸæ•°æ®ï¼›å®¢æˆ·ç«¯ä¸æ³„éœ²å¯†é’¥
* [ ] è¡¨å•ä¸ Actionsï¼šCSRF/Rate Limit/WAF è§„åˆ™
* [ ] éšç§ä¸æ—¥å¿—ï¼šPII è„±æ•ã€è®¿é—®æ—¥å¿—ç•™å­˜ä¸æ¸…ç†å‘¨æœŸ

### æ€§èƒ½ä¸å‰ç«¯è´¨é‡

* [ ] èµ„æºé¢„å–ï¼š`preload/prefetch` ä¸ HTTP/2 Pushï¼ˆæˆ– 103 Early Hintsï¼‰
* [ ] å›¾ç‰‡ç­–ç•¥ï¼šå“åº”å¼ `srcset`ã€å ä½ LQIP/BlurHashã€å»¶è¿ŸåŠ è½½é˜ˆå€¼
* [ ] å­—ä½“ç­–ç•¥ï¼šå¯å˜å­—ä½“ã€`font-display: swap`ã€å­é›†åŒ–
* [ ] ä»£ç åˆ†å‰²ï¼šè·¯ç”±çº§ä¸ç»„ä»¶çº§ï¼›é¿å…å¤§ä½“ç§¯ client ä¾èµ–
* [ ] é”™è¯¯è¾¹ç•Œä¸ç¦»çº¿å…œåº•ï¼ˆSW å¯é€‰ï¼‰

### SEO / å¯è®¿é—®æ€§ / å›½é™…åŒ–

* [ ] è¯­ä¹‰åŒ– HTMLã€head å…ƒä¿¡æ¯ã€ç»“æ„åŒ–æ•°æ®ï¼ˆJSON-LDï¼‰
* [ ] Sitemapã€Robotsã€Canonicalã€å¤šè¯­è¨€ `hreflang`
* [ ] A11y åŸºçº¿ï¼šå¯¹æ¯”åº¦ã€é”®ç›˜å¯è¾¾ã€ARIAã€ç„¦ç‚¹ç®¡ç†
* [ ] i18nï¼šæ–‡æ¡ˆæŠ½å–ã€è¯­è¨€åˆ‡æ¢ã€åŒºåŸŸåŒ–è·¯ç”±

### è¿ç»´ä¸å›æ»š

* [ ] é™æ€é¢ï¼š`manifest.json` æŒ‡é’ˆå›æ»šï¼›S3 ç‰ˆæœ¬åŒ–ä¸€é”®è¿˜åŸ
* [ ] SSR é¢ï¼šè“ç»¿/é‡‘ä¸é›€å‘å¸ƒï¼Œæ•…éšœè‡ªåŠ¨å›åˆ‡
* [ ] ç¾å¤‡ï¼šå¤šåŒºåŸŸå¯¹è±¡å¤åˆ¶ã€è·¨åŒºåŸŸ CDN å¤±æ•ˆé¢„æ¡ˆ
* [ ] Runbookï¼šå†ç”Ÿå¤±è´¥ã€CDN å‘½ä¸­éª¤é™ã€SSR 502ã€ç¼“å­˜æ±¡æŸ“çš„å¤„ç½®æµç¨‹

---

## ğŸ“ˆ æœªæ¥æ‰©å±•

* å¢åŠ  **å¤šåŒºåŸŸåˆ†å¸ƒå¼å†ç”Ÿ**ï¼ˆEdge ISRï¼‰ã€‚
* å¼•å…¥ **Server Actions + PPR**ï¼ˆReact 19 æ–°ç‰¹æ€§ï¼‰ã€‚
* æ‰“é€š **ç›‘æ§é¢æ¿**ï¼ˆTTFB / å†ç”Ÿé˜Ÿåˆ— / å‘½ä¸­ç‡ï¼‰ã€‚

---

### ğŸ§© æ€»ç»“ä¸€å¥è¯

> **ä¸€æ­¥æ­¥æ¼”è¿›ï¼šSSG â†’ RSC â†’ ISR â†’ SSR**ï¼Œä¿æŒå•é¡¹ç›®ã€åŒäº§ç‰©ã€è·¯ç”±çº§é…ç½®ä¸ CDN åˆ†æµï¼Œè®©å‰ç«¯æ¸²æŸ“æ¶æ„æ—¢è½»é‡ã€å¯è§‚æµ‹ï¼Œåˆèƒ½éšä¸šåŠ¡åŠ¨æ€æ‰©å±•ã€‚
